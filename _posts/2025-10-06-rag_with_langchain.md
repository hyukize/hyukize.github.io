---
title: "RAG 이해와 LangChain으로 구축하기"
date: 2025-10-06 08:00:00 +0900
categories: [AI]
tags: [rag, llm, langchain, vectordb]
---

# RAG(Retrieval-Augmented Generation) 이해하기

최근 대형 언어 모델(LLM)의 활용이 늘어나면서 **RAG**라는 개념이 주목받고 있습니다. 간단히 말해 RAG는 **외부 문서를 검색하여 LLM이 답변 생성에 참고하도록 하는 구조**입니다. 이를 통해 LLM의 최신성 부족, 사내 데이터 미활용, 환각(hallucination) 문제를 보완할 수 있습니다.

---

## 왜 RAG인가?

기존 ChatGPT와 같은 모델은 다음과 같은 한계를 가지고 있습니다:
1. 최신 정보가 반영되어 있지 않음
2. 기업 내부의 문서, 데이터 활용 불가
3. 출처 불명으로 인한 잘못된 답변(환각) 발생 가능
4. 특정 도메인 지식에 약함

**RAG는 이러한 한계를 보완**하여, 최신 문서와 DB를 기반으로 답변을 생성하고 신뢰성을 높여줍니다.

---

## RAG 파이프라인 (사전 단계: Pre-process)

RAG는 단순 업로드 이상의 과정을 필요로 합니다. 일반적인 사전 단계는 다음과 같습니다.

1. **문서 로드(Document Load)**: PDF, Word, 웹페이지 등 다양한 문서 불러오기
2. **텍스트 분할(Text Split)**: 문서를 적절한 단위(청크)로 분할, 필요 시 오버랩 적용
3. **임베딩(Embedding)**: 각 청크를 벡터로 변환하여 의미를 수치화
4. **벡터 스토어 저장(Vector Store)**: 벡터와 메타데이터를 DB에 저장하여 검색 대비

예: *“새콤달콤한 맛” → ‘단맛’, ‘신맛’과 유사도 계산을 통해 연관 문서 검색 가능.*

---

## RAG 파이프라인 (실행 단계: Runtime)

1. **리트리버(Retriever)**: 쿼리를 임베딩 후 DB에서 유사도 높은 청크 검색
2. **프롬프트 구성(Prompting)**: 검색된 청크를 LLM에 컨텍스트로 전달
3. **LLM 응답**: 근거 기반 답변 생성 (출처 포함 가능)
4. **체인 생성(Chain)**: LangChain 등으로 전체 프로세스를 하나의 파이프라인으로 묶음

---

## 성능 비교 및 효과

- **구현 난이도**: Prompt Eng. < **RAG** << PEFT < Full Fine-tuning
- **최신성**: 사용자가 직접 최신 문서를 DB에 넣어 업데이트 가능 → RAG가 압도적
- **투명성**: 어떤 문서가 답변에 사용되었는지 추적 가능
- **환각 방지**: “근거 문서 기반 답변”을 강제하여 잘못된 추측 최소화

실험 결과, 단순 검색 대비 정확도가 **45% → 98%**까지 향상되었습니다.

---

## LangChain으로 직접 구축하기

LangChain은 RAG 파이프라인을 쉽게 설계할 수 있는 프레임워크입니다.

- **모듈화**: 문서 로드 → 임베딩 → 벡터 저장 → 검색 → 답변 과정을 체인으로 구성
- **유연성**: 임베딩 모델, 벡터DB(Milvus 등), 검색 알고리즘(MMR 등) 자유롭게 교체 가능
- **추적성**: LangSmith로 검색·생성 과정을 투명하게 모니터링

```python
chain = (
  {"context": retriever, "question": RunnablePassthrough()}
  | prompt
  | llm
  | StrOutputParser()
)

question = "삼성전자가 신규 개발한 AI의 이름은?"
response = chain.invoke(question)
print(response)
```

---

## 마무리

RAG는 단순히 최신성을 확보하는 것뿐 아니라, **정확성·투명성·안정성**을 모두 강화하는 방법입니다. 특히 기업 내부 문서, 전문 도메인 지식이 필요한 상황에서는 필수적인 접근법입니다. LangChain을 활용해 직접 RAG 시스템을 구축해본다면, ChatGPT 같은 LLM을 보다 강력하고 신뢰성 있게 사용할 수 있을 것입니다.

---

👉 다음 글에서는 **RAG 시스템을 실제로 구현하는 코드 예제**와 **최적화 팁**을 다룰 예정입니다.

